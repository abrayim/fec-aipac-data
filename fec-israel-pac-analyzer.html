<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FEC Israel PAC Analyzer (Corrected Methodology)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0f1419;
            --bg-secondary: #1a1f26;
            --bg-tertiary: #242b33;
            --bg-highlight: #2d363f;
            --text-primary: #e7e9ea;
            --text-secondary: #8b98a5;
            --text-muted: #6e7b8b;
            --accent-green: #00ba7c;
            --accent-green-dim: rgba(0, 186, 124, 0.15);
            --accent-blue: #1d9bf0;
            --accent-blue-dim: rgba(29, 155, 240, 0.15);
            --accent-orange: #ff7a00;
            --accent-orange-dim: rgba(255, 122, 0, 0.15);
            --accent-red: #f4212e;
            --border-color: #2f3336;
            --border-light: #3a4249;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }
        
        .header {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .header h1 {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
        }
        
        .header p {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }
        
        .methodology-note {
            background: var(--accent-blue-dim);
            border: 1px solid rgba(29, 155, 240, 0.3);
            border-radius: 8px;
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
            font-size: 0.875rem;
        }
        
        .methodology-note strong {
            color: var(--accent-blue);
        }
        
        .methodology-note code {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-tertiary);
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .upload-zone {
            background: var(--bg-secondary);
            border: 2px dashed var(--border-light);
            border-radius: 12px;
            padding: 3rem 2rem;
            text-align: center;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .upload-zone:hover {
            border-color: var(--accent-blue);
            background: var(--bg-tertiary);
        }
        
        .upload-btn {
            background: var(--accent-blue);
            color: white;
            border: none;
            padding: 0.875rem 1.75rem;
            border-radius: 9999px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .upload-btn:hover {
            background: #1a8cd8;
        }
        
        .upload-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .upload-hint {
            color: var(--text-muted);
            font-size: 0.85rem;
            margin-top: 1rem;
        }
        
        .error-box {
            background: rgba(244, 33, 46, 0.1);
            border: 1px solid rgba(244, 33, 46, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            color: var(--accent-red);
            font-size: 0.9rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .stat-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.25rem;
        }
        
        .stat-label {
            font-size: 0.75rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
        }
        
        .stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            letter-spacing: -0.02em;
        }
        
        .stat-value.green { color: var(--accent-green); }
        .stat-value.blue { color: var(--accent-blue); }
        .stat-value.orange { color: var(--accent-orange); }
        
        .stat-detail {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }
        
        .section {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin-bottom: 1.5rem;
            overflow: hidden;
        }
        
        .section-header {
            padding: 1rem 1.25rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .section-title {
            font-size: 1rem;
            font-weight: 600;
        }
        
        .badge {
            font-size: 0.7rem;
            padding: 0.25rem 0.6rem;
            border-radius: 9999px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .badge.green {
            background: var(--accent-green-dim);
            color: var(--accent-green);
        }
        
        .badge.orange {
            background: var(--accent-orange-dim);
            color: var(--accent-orange);
        }
        
        .table-wrapper {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }
        
        th {
            text-align: left;
            padding: 0.75rem 1rem;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            background: var(--bg-tertiary);
            position: sticky;
            top: 0;
        }
        
        th.right, td.right {
            text-align: right;
        }
        
        td {
            padding: 0.75rem 1rem;
            border-top: 1px solid var(--border-color);
            vertical-align: top;
        }
        
        tr:hover td {
            background: var(--bg-tertiary);
        }
        
        .pac-name {
            font-weight: 500;
        }
        
        .pac-id {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }
        
        .amount {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 500;
        }
        
        .amount.positive { color: var(--accent-green); }
        
        .type-badge {
            display: inline-block;
            font-size: 0.65rem;
            padding: 0.15rem 0.5rem;
            border-radius: 4px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .type-badge.bundled {
            background: var(--accent-blue-dim);
            color: var(--accent-blue);
        }
        
        .type-badge.direct {
            background: var(--accent-orange-dim);
            color: var(--accent-orange);
        }
        
        .footer-note {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 1rem 1.25rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 1.5rem;
        }
        
        .footer-note a {
            color: var(--accent-blue);
            text-decoration: none;
        }
        
        .footer-note a:hover {
            text-decoration: underline;
        }
        
        .help-section {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .help-section h3 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        
        .help-section ol {
            padding-left: 1.25rem;
            color: var(--text-secondary);
        }
        
        .help-section li {
            margin-bottom: 0.5rem;
        }
        
        .help-section a {
            color: var(--accent-blue);
            text-decoration: none;
        }
        
        .help-section a:hover {
            text-decoration: underline;
        }
        
        .filter-info {
            background: var(--bg-tertiary);
            border-radius: 6px;
            padding: 0.75rem 1rem;
            margin-top: 1rem;
            font-size: 0.8rem;
        }
        
        .filter-info code {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-primary);
            padding: 0.1rem 0.3rem;
            border-radius: 3px;
        }
        
        .totals-row td {
            background: var(--bg-tertiary) !important;
            font-weight: 700;
            border-top: 2px solid var(--border-light);
        }
        
        .contributor-name {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 1.4rem;
            }
            
            .upload-zone {
                padding: 2rem 1rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .stat-value {
                font-size: 1.4rem;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useRef } = React;
        
        // Israel-related PAC data from TrackAIPAC.com (52 PACs)
        const ISRAEL_PACS = {
            'C00797670': 'American Israel Public Affairs Committee PAC',
            'C00492579': 'American Principles',
            'C00687657': 'American Pro-Israel PAC',
            'C00138701': 'Americans for Good Government',
            'C00113019': 'Americans United in Support of Democracy',
            'C00155713': 'BAYPAC',
            'C00381624': 'Because I Care PAC',
            'C00204388': 'Bi-County PAC',
            'C00110585': 'Citizens Organized Political Action Committee',
            'C00187526': 'City PAC',
            'C00152579': 'Delaware Valley PAC',
            'C00429571': 'California Jewish Democrats-FED',
            'C00710848': 'DMFI PAC (Democratic Majority for Israel)',
            'C00265470': 'Friends of Israel',
            'C00141747': 'San Franciscans for Good Government',
            'C00169136': 'Garden State PAC',
            'C00473249': 'Grand Canyon State Caucus',
            'C00131557': 'Heartland PAC',
            'C00158865': 'Hudson Valley PAC',
            'C00557926': 'I-PAC JAX',
            'C00815753': 'J Street Action Fund',
            'C00139659': 'Joint Action Committee for Political Affairs',
            'C00441949': 'JStreetPAC',
            'C00144170': 'Louisianians for American Security PAC',
            'C00195024': 'Maryland Association for Concerned Citizens PAC',
            'C00165944': 'Mid Manhattan PAC',
            'C00199950': 'MOPAC',
            'C00189696': 'Multi-Issue PAC',
            'C00147983': 'National Action Committee',
            'C00150995': 'National PAC',
            'C00247403': 'NorPAC',
            'C00302414': 'Northwest PAC',
            'C00232611': 'PAC of Cherry Hill New Jersey',
            'C00878801': 'Preserve America PAC (Miriam Adelson)',
            'C00756882': 'Preserve America PAC (Sheldon Adelson)',
            'C00740936': 'Pro-Israel America Action Fund',
            'C00699470': 'Pro-Israel America PAC',
            'C90012063': 'Republican Jewish Coalition',
            'C00345132': 'Republican Jewish Coalition-PAC',
            'C00148155': 'St. Louisans for Better Government',
            'C00378216': 'SunPAC',
            'C00102368': 'The Desert Caucus',
            'C00135541': 'To Protect Our Heritage PAC',
            'C00799031': 'United Democracy Project (UDP)',
            'C00152280': 'United PAC (Illinois)',
            'C00127811': 'US Israel PAC',
            'C00138560': 'Washington PAC',
            'C00203182': "Women's Pro-Israel National PAC",
            'C00236596': 'World Alliance for Israel PAC',
            'C00305607': 'Young Jewish Leadership PAC',
            'C00891259': 'Zioness PAC',
            'C00548628': 'Zionist Organization of America',
            'C00309781': 'Phoenix Education Partners'
        };
        
        function FECAnalyzer() {
            const [results, setResults] = useState(null);
            const [error, setError] = useState(null);
            const [loading, setLoading] = useState(false);
            const [filterStats, setFilterStats] = useState(null);
            const fileInputRef = useRef(null);
            
            const handleFileUpload = (event) => {
                const file = event.target.files[0];
                if (!file) return;
                
                setLoading(true);
                setError(null);
                setResults(null);
                setFilterStats(null);
                
                Papa.parse(file, {
                    header: true,
                    skipEmptyLines: true,
                    complete: (results) => {
                        try {
                            analyzeData(results.data);
                        } catch (err) {
                            setError(`Error analyzing file: ${err.message}`);
                            setLoading(false);
                        }
                    },
                    error: (error) => {
                        setError(`Error parsing CSV: ${error.message}`);
                        setLoading(false);
                    }
                });
            };
            
            const analyzeData = (data) => {
                const matches = [];
                let totalAmount = 0;
                let bundledTotal = 0;
                let directTotal = 0;
                let bundledCount = 0;
                let directCount = 0;
                
                // Track filtering stats
                let totalRows = data.length;
                let memoExcluded = 0;
                let afterMemoFilter = 0;
                
                data.forEach((row) => {
                    // CRITICAL FIX #1: Apply memo_code filter to avoid double-counting
                    // memo_code = 'X' indicates documentation/memo entries, not actual contributions
                    const memoCode = (row.memo_code || '').trim().toUpperCase();
                    if (memoCode === 'X') {
                        memoExcluded++;
                        return; // Skip memo entries
                    }
                    
                    afterMemoFilter++;
                    
                    // Get contributor_id - try multiple field names for compatibility
                    // FEC bulk data uses 'contributor_id', some exports use 'unused_contbr_id'
                    const contributorId = (
                        row.contributor_id || 
                        row.unused_contbr_id || 
                        row.contbr_id ||
                        ''
                    ).trim();
                    
                    const entityType = (row.entity_type || '').trim().toUpperCase();
                    const receiptType = (row.receipt_type || row.receipt_description || '').trim();
                    
                    // CRITICAL FIX #2: Match against pro-Israel PAC list
                    // This catches BOTH bundled individual contributions AND direct PAC contributions
                    if (contributorId && ISRAEL_PACS[contributorId]) {
                        const amount = parseFloat(row.contribution_receipt_amount) || 0;
                        
                        // Determine contribution type
                        // - Bundled: entity_type = 'IND' (individual giving through PAC conduit)
                        // - Direct: entity_type = 'PAC' (PAC treasury funds)
                        let contributionType;
                        if (entityType === 'IND') {
                            contributionType = 'bundled';
                            bundledTotal += amount;
                            bundledCount++;
                        } else if (entityType === 'PAC') {
                            contributionType = 'direct';
                            directTotal += amount;
                            directCount++;
                        } else {
                            // Other entity types (rare) - categorize as "other"
                            contributionType = 'other';
                        }
                        
                        totalAmount += amount;
                        
                        matches.push({
                            pacId: contributorId,
                            pacName: ISRAEL_PACS[contributorId],
                            contributorName: row.contributor_name || 'Unknown',
                            amount: amount,
                            date: row.contribution_receipt_date || 'Unknown',
                            candidateName: row.candidate_name || 'N/A',
                            entityType: entityType,
                            receiptType: receiptType,
                            contributionType: contributionType
                        });
                    }
                });
                
                // Sort by date (most recent first)
                matches.sort((a, b) => {
                    if (a.date === 'Unknown') return 1;
                    if (b.date === 'Unknown') return -1;
                    return new Date(b.date) - new Date(a.date);
                });
                
                // Collect all years
                const allYears = new Set();
                matches.forEach(match => {
                    if (match.date && match.date !== 'Unknown') {
                        try {
                            const year = new Date(match.date).getFullYear();
                            if (!isNaN(year)) allYears.add(year);
                        } catch (e) {}
                    }
                });
                const sortedYears = Array.from(allYears).sort();
                
                // Group by PAC
                const groupedByPac = {};
                matches.forEach(match => {
                    if (!groupedByPac[match.pacId]) {
                        groupedByPac[match.pacId] = {
                            pacName: match.pacName,
                            contributions: [],
                            total: 0,
                            bundledTotal: 0,
                            directTotal: 0,
                            byYear: {}
                        };
                        sortedYears.forEach(year => {
                            groupedByPac[match.pacId].byYear[year] = 0;
                        });
                    }
                    
                    groupedByPac[match.pacId].contributions.push(match);
                    groupedByPac[match.pacId].total += match.amount;
                    
                    if (match.contributionType === 'bundled') {
                        groupedByPac[match.pacId].bundledTotal += match.amount;
                    } else if (match.contributionType === 'direct') {
                        groupedByPac[match.pacId].directTotal += match.amount;
                    }
                    
                    if (match.date && match.date !== 'Unknown') {
                        try {
                            const year = new Date(match.date).getFullYear();
                            if (!isNaN(year)) {
                                groupedByPac[match.pacId].byYear[year] += match.amount;
                            }
                        } catch (e) {}
                    }
                });
                
                setFilterStats({
                    totalRows,
                    memoExcluded,
                    afterMemoFilter,
                    matchedRows: matches.length
                });
                
                setResults({
                    totalMatches: matches.length,
                    totalAmount,
                    bundledTotal,
                    directTotal,
                    bundledCount,
                    directCount,
                    matches,
                    groupedByPac,
                    years: sortedYears
                });
                
                setLoading(false);
            };
            
            const formatCurrency = (amount) => {
                return new Intl.NumberFormat('en-US', {
                    style: 'currency',
                    currency: 'USD',
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                }).format(amount);
            };
            
            const formatDate = (dateStr) => {
                if (dateStr === 'Unknown' || !dateStr) return 'Unknown';
                try {
                    const date = new Date(dateStr);
                    return date.toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'short',
                        day: 'numeric'
                    });
                } catch {
                    return dateStr;
                }
            };
            
            return (
                <div className="container">
                    <div className="header">
                        <h1>FEC Israel PAC Analyzer</h1>
                        <p>Analyze campaign contributions from pro-Israel PACs using corrected FEC methodology</p>
                    </div>
                    
                
                    
                    <div 
                        className="upload-zone"
                        onClick={() => fileInputRef.current?.click()}
                    >
                        <input
                            ref={fileInputRef}
                            type="file"
                            accept=".csv"
                            onChange={handleFileUpload}
                            style={{ display: 'none' }}
                        />
                        <button 
                            className="upload-btn"
                            disabled={loading}
                        >
                            {loading ? 'Analyzing...' : 'Upload FEC CSV File'}
                        </button>
                        <p className="upload-hint">
                            Supports FEC.gov bulk data exports (Schedule A contributions)
                        </p>
                    </div>
                    
                    {error && (
                        <div className="error-box">
                            <strong>Error:</strong> {error}
                        </div>
                    )}
                    
                    {filterStats && (
                        <div className="filter-info">
                            <strong>Filtering:</strong> {filterStats.totalRows.toLocaleString()} total rows → 
                            {filterStats.memoExcluded.toLocaleString()} memo entries excluded → 
                            {filterStats.afterMemoFilter.toLocaleString()} after filter → 
                            {filterStats.matchedRows.toLocaleString()} matched pro-Israel PACs
                        </div>
                    )}
                    
                    {results && (
                        <>
                            <div className="stats-grid">
                                <div className="stat-card">
                                    <div className="stat-label">Total Amount</div>
                                    <div className="stat-value green">{formatCurrency(results.totalAmount)}</div>
                                    <div className="stat-detail">{results.totalMatches} contributions</div>
                                </div>
                                <div className="stat-card">
                                    <div className="stat-label">Bundled Individual</div>
                                    <div className="stat-value blue">{formatCurrency(results.bundledTotal)}</div>
                                    <div className="stat-detail">{results.bundledCount} contributions (15E earmarked)</div>
                                </div>
                                <div className="stat-card">
                                    <div className="stat-label">Direct PAC</div>
                                    <div className="stat-value orange">{formatCurrency(results.directTotal)}</div>
                                    <div className="stat-detail">{results.directCount} contributions (15K treasury)</div>
                                </div>
                                <div className="stat-card">
                                    <div className="stat-label">PACs Matched</div>
                                    <div className="stat-value">{Object.keys(results.groupedByPac).length}</div>
                                    <div className="stat-detail">of {Object.keys(ISRAEL_PACS).length} tracked</div>
                                </div>
                            </div>
                            
                            <div className="section">
                                <div className="section-header">
                                    <span className="section-title">Summary by PAC</span>
                                </div>
                                <div className="table-wrapper">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>PAC Name</th>
                                                <th className="right">Bundled</th>
                                                <th className="right">Direct</th>
                                                {results.years.map(year => (
                                                    <th key={year} className="right">{year}</th>
                                                ))}
                                                <th className="right">Total</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {Object.entries(results.groupedByPac)
                                                .sort((a, b) => b[1].total - a[1].total)
                                                .map(([pacId, data]) => (
                                                    <tr key={pacId}>
                                                        <td>
                                                            <div className="pac-name">{data.pacName}</div>
                                                            <div className="pac-id">{pacId}</div>
                                                        </td>
                                                        <td className="right">
                                                            {data.bundledTotal > 0 && (
                                                                <span className="amount" style={{color: 'var(--accent-blue)'}}>
                                                                    {formatCurrency(data.bundledTotal)}
                                                                </span>
                                                            )}
                                                        </td>
                                                        <td className="right">
                                                            {data.directTotal > 0 && (
                                                                <span className="amount" style={{color: 'var(--accent-orange)'}}>
                                                                    {formatCurrency(data.directTotal)}
                                                                </span>
                                                            )}
                                                        </td>
                                                        {results.years.map(year => (
                                                            <td key={year} className="right">
                                                                {data.byYear[year] > 0 ? (
                                                                    <span className="amount">{formatCurrency(data.byYear[year])}</span>
                                                                ) : '-'}
                                                            </td>
                                                        ))}
                                                        <td className="right">
                                                            <span className="amount positive">{formatCurrency(data.total)}</span>
                                                        </td>
                                                    </tr>
                                                ))}
                                        </tbody>
                                        <tfoot>
                                            <tr className="totals-row">
                                                <td><strong>TOTAL</strong></td>
                                                <td className="right">
                                                    <span className="amount" style={{color: 'var(--accent-blue)'}}>
                                                        {formatCurrency(results.bundledTotal)}
                                                    </span>
                                                </td>
                                                <td className="right">
                                                    <span className="amount" style={{color: 'var(--accent-orange)'}}>
                                                        {formatCurrency(results.directTotal)}
                                                    </span>
                                                </td>
                                                {results.years.map(year => {
                                                    const yearTotal = Object.values(results.groupedByPac)
                                                        .reduce((sum, pac) => sum + (pac.byYear[year] || 0), 0);
                                                    return (
                                                        <td key={year} className="right">
                                                            <span className="amount">{formatCurrency(yearTotal)}</span>
                                                        </td>
                                                    );
                                                })}
                                                <td className="right">
                                                    <span className="amount positive">{formatCurrency(results.totalAmount)}</span>
                                                </td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                            
                            <div className="section">
                                <div className="section-header">
                                    <span className="section-title">All Transactions</span>
                                    <span className="badge green">{results.matches.length} total</span>
                                </div>
                                <div className="table-wrapper" style={{maxHeight: '500px', overflow: 'auto'}}>
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Date</th>
                                                <th>Type</th>
                                                <th>PAC</th>
                                                <th>Contributor</th>
                                                <th className="right">Amount</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {results.matches.map((match, idx) => (
                                                <tr key={idx}>
                                                    <td style={{whiteSpace: 'nowrap'}}>{formatDate(match.date)}</td>
                                                    <td>
                                                        <span className={`type-badge ${match.contributionType}`}>
                                                            {match.contributionType === 'bundled' ? 'Bundled' : 
                                                             match.contributionType === 'direct' ? 'Direct' : 'Other'}
                                                        </span>
                                                    </td>
                                                    <td>
                                                        <div className="pac-name">{match.pacName}</div>
                                                        <div className="pac-id">{match.pacId}</div>
                                                    </td>
                                                    <td>
                                                        <div className="contributor-name">{match.contributorName}</div>
                                                    </td>
                                                    <td className="right">
                                                        <span className="amount positive">{formatCurrency(match.amount)}</span>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <div className="footer-note">
                                <strong>Data Sources:</strong> Pro-Israel PAC list from{' '}
                                <a href="https://trackaipac.com" target="_blank" rel="noopener noreferrer">Track AIPAC</a>.
                                Methodology based on FEC bulk data analysis. Note: This captures contributions only, 
                                not Independent Expenditures (IEs) which are reported separately on Schedule E.
                            </div>
                        </>
                    )}
                    
                    <div className="help-section">
                        <h3>How to Use</h3>
                        <ol>
                            <li>Go to <a href="https://www.fec.gov/data/receipts/?data_type=processed" target="_blank" rel="noopener noreferrer">FEC.gov Receipts</a></li>
                            <li>Search for your candidate's committee and filter as needed</li>
                            <li>Click "Export" and download the CSV file</li>
                            <li>Upload the CSV file using the button above</li>
                        </ol>
                        
                        <div className="filter-info" style={{marginTop: '1rem'}}>
                            <strong>Key Methodology Points:</strong><br/>
                            • <code>memo_code != 'X'</code> filter prevents double-counting earmarked contributions<br/>
                            • Bundled Individual = Individual donors giving through PAC's conduit system (entity_type=IND)<br/>
                            • Direct PAC = PAC treasury contributions (entity_type=PAC, limited to $5,000/election)
                        </div>
                    </div>
                </div>
            );
        }
        
        ReactDOM.render(<FECAnalyzer />, document.getElementById('root'));
    </script>
</body>
</html>
